const init_grid=function(){$("#BOARD .STICKY").stickyWidget(),$("#BOARD").on("dragover",".TARGET",dragover),$("#BOARD").on("dragstart",".CARD",dragstart),$("#BOARD").on("dragend",".CARD",dragend)},dragover=function(e){e.preventDefault();const t=e.target,n=document.querySelector("#BOARD div.DRAGGING"),r=insert_above(t,e.clientY);n.classList.contains("CARD")&&t.classList.contains("TARGET")&&(n?t.insertBefore(n,r):t.appendChild(n))},dragstart=function(e){if((e.originalEvent||e).dataTransfer.effectAllowed="move",!e.target.classList.contains("CARD")){if(!e.target.parentElement.classList.contains("CARD"))return void e.preventDefault();e.target.parentElement.classList.add("DRAGGING")}e.target.classList.add("DRAGGING")},dragend=function(e){const t=document.querySelector("#BOARD div.DRAGGING");if(!t)return void e.preventDefault();t.classList.remove("DRAGGING");const n=e.target.parentElement.getAttribute("id"),r=e.target.parentElement.parentElement.getAttribute("id"),o=0===n.indexOf("CARD_")?r:n,s=t.getAttribute("id").replace("CARD_",""),a=o.replace("STATUS_","").split("_SWIMLANE_")[0],l=o.replace("STATUS_","").split("_SWIMLANE_")[1],i=document.getElementById(o).querySelectorAll(".CARD");var c=[];i.forEach((function(e){c.push(e.getAttribute("id").replace("CARD_",""))})),c=c.join(":"),console.group("CARD_MOVED"),console.log("CARD     :",s),console.log("TARGET   :",o,n,r),console.log("STATUS   :",a),console.log("SWIMLANE :",l),console.log("SORTED   :",c),console.groupEnd(),apex.server.process("UPDATE_CARD",{x01:s,x02:a,x03:l,x04:c},{dataType:"text",success:function(e){console.log("RESULT",e),e.indexOf("sqlerrm")>=0?apex.message.showErrors([{type:"error",location:["page","inline"],pageItem:"",message:e.split("sqlerrm:")[1],unsafe:!1}]):apex.message.showPageSuccess(e)}})},insert_above=(e,t)=>{let n=null,r=Number.NEGATIVE_INFINITY;return e.querySelectorAll(".CARD:not(.DRAGGING)").forEach((e=>{const{top:o}=e.getBoundingClientRect(),s=t-o;s<0&&s>r&&(r=s,n=e)})),n};